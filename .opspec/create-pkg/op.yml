name: create-pkg
description: automates the creation of a new pkg
inputs:
  githubAccessToken:
    string:
      constraints: { minLength: 1 }
      description: >
        personal access token for github; see
        https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/ for how to create a github access token.
        It will need scopes admin:org, repo, and admin:repo_hook
  name:
    string:
      constraints: { minLength: 3 }
      description: name of the pkg
  description:
    string:
      constraints: { minLength: 1 }
      description: description of the pkg
run:
  serial:
    - op:
        pkg: { ref: github.com/opspec-pkgs/github.repo.create#1.0.0 }
        inputs:
          name:
          accessToken: $(githubAccessToken)
          description: $(description)
          isWikiEnabled: 'false'
          org: opspec-pkgs
    - op:
        pkg: { ref: github.com/opspec-pkgs/github.repo.team.add#1.0.0 }
        inputs:
          accessToken: $(githubAccessToken)
          repo: $(name)
          teamId: '2422602'
          org: opspec-pkgs
          permission: admin
    - op:
        pkg: { ref: github.com/opspec-pkgs/travis-ci.enable#1.0.0 }
        inputs:
          githubAccessToken:
          repo: opspec-pkgs/$(name)
